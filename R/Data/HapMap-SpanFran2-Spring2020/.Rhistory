# Folder containing data
setwd("C:/Users/patri/OneDrive - The Pennsylvania State University/GitHub Repositories/NoduleTraits-MedicagoGenetics/Data/HapMap-SpanFran2-Spring2020")
#load large data set and preliminary lobed nodule count data
df <- read.csv("df_summary.csv")
lobe_df <- read.csv("nodule_lobe_count_trial.csv")
colnames(lobe_df) <- c('pot', 'lobed_nodule_count') #fix colnames
#join data together and remove rows with NAs for PCA
library(dplyr)
df <- df %>% right_join(lobe_df) %>% filter(!is.na(lobed_nodule_count))
#create porp lobed variable
df$porp.lobed.nodules <- df$lobed_nodule_count / df$nodule_raw_count
#remove columns to be excluded in PCA
df <- df %>% select(-nodule_calc_count, -X, -pot, -porp.harvest, -file,
-starts_with('StdDev')) %>%
select(-Perim._range) #prcomp does not like the zeros in this column
library(devtools)
install_github("vqv/ggbiplot")
mypca<-prcomp(df, center = TRUE, scale. = TRUE)
mypca<-prcomp(df, center = TRUE)
w<-ggbiplot(mypca,ellipse = FALSE)+ theme_minimal()
library(ggbiplot)
mypca<-prcomp(df, center = TRUE)
w<-ggbiplot(mypca,ellipse = FALSE)+ theme_minimal()
w
View(df)
df_means <- df %>% select(nodule_raw_count, porp.lobed.nodules, lobed_nodule_count,
ends_with("mean"))
library(devtools)
#install_github("vqv/ggbiplot")
library(ggbiplot)
mypca<-prcomp(df_means, center = TRUE, scale. = TRUE)
w<-ggbiplot(mypca,ellipse = FALSE)+ theme_minimal()
w
df_means %>% ggplot(aes(x = Area_mean, y = porp.lobed.nodules)) %>%
geom_point()
df_means %>% ggplot(aes(x = Area_mean, y = porp.lobed.nodules)) +
geom_point()
df_means %>% ggplot(aes(x = MinFeret_mean, y = porp.lobed.nodules)) +
geom_point()
